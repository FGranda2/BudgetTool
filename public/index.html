<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CoupleSplit Budget</title>
  <style>
    :root{
      /* Blue / Purple / Green palette */
      --bg0:#071022;
      --bg1:#0b1630;
      --card: rgba(255,255,255,.06);
      --card2: rgba(255,255,255,.09);
      --stroke: rgba(255,255,255,.12);
      --text:#eaf2ff;
      --muted: rgba(234,242,255,.70);

      --blue:#3b82f6;
      --purple:#7c3aed;
      --green:#22c55e;
      --cyan:#22d3ee;

      --shadow: 0 20px 60px rgba(0,0,0,.45);
      --r12: 12px;
      --r16: 16px;
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      color:var(--text);
      font: 14px/1.35 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1200px 600px at 20% 10%, rgba(124,58,237,.25), transparent 60%),
        radial-gradient(1000px 500px at 80% 20%, rgba(59,130,246,.25), transparent 60%),
        radial-gradient(900px 450px at 60% 95%, rgba(34,197,94,.18), transparent 60%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    a{ color:inherit; }

    .wrap{
      max-width: 1120px;
      margin: 0 auto;
      padding: 28px 18px 60px;
    }

    /* Top bar */
    .top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      margin-bottom:18px;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:12px;
    }

    .logo{
      width:42px;height:42px;border-radius:14px;
      background:
        radial-gradient(16px 16px at 30% 30%, rgba(255,255,255,.25), transparent 60%),
        linear-gradient(135deg, rgba(59,130,246,.95), rgba(124,58,237,.95) 60%, rgba(34,197,94,.95));
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      border: 1px solid rgba(255,255,255,.18);
    }

    .brand h1{
      font-size:16px;
      margin:0;
      letter-spacing:.2px;
    }
    .brand p{
      margin:2px 0 0;
      color:var(--muted);
      font-size:12px;
    }

    .controls{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
      align-items:center;
    }

    .chip{
      display:flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      border-radius:999px;
      background: rgba(255,255,255,.04);
      border: 1px solid var(--stroke);
      backdrop-filter: blur(10px);
    }
    .chip label{ color:var(--muted); font-size:12px; }
    .chip input, .chip select{
      background: transparent;
      border: 0;
      outline: none;
      color: var(--text);
      font-weight: 600;
      min-width: 140px;
    }
    .chip input::placeholder{ color: rgba(234,242,255,.45); font-weight:500; }
    .chip select option{ color:#0b1630; }

    /* Main grid */
    .grid{
      display:grid;
      grid-template-columns: 420px 1fr;
      gap: 16px;
      align-items:start;
    }

    @media (max-width: 980px){
      .grid{ grid-template-columns: 1fr; }
    }

    .card{
      border-radius: var(--r16);
      background: var(--card);
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      overflow:hidden;
    }
    .card .hd{
      padding: 14px 14px 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      background: linear-gradient(180deg, rgba(255,255,255,.05), transparent);
    }
    .card .hd h2{
      margin:0;
      font-size: 13px;
      letter-spacing: .25px;
      text-transform: uppercase;
      color: rgba(234,242,255,.86);
    }
    .card .bd{ padding: 14px; }

    /* Summary */
    .summary{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 12px;
    }
    @media (max-width: 560px){
      .summary{ grid-template-columns: 1fr; }
    }

    .stat{
      border-radius: var(--r12);
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.10);
      padding: 12px;
      position:relative;
      overflow:hidden;
    }
    .stat:before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(240px 80px at 20% 10%, rgba(59,130,246,.18), transparent 60%),
        radial-gradient(240px 80px at 70% 30%, rgba(124,58,237,.18), transparent 60%),
        radial-gradient(260px 90px at 60% 110%, rgba(34,197,94,.16), transparent 60%);
      pointer-events:none;
      filter: blur(10px);
      opacity:.85;
    }
    .stat > *{ position:relative; }
    .stat .k{ color:var(--muted); font-size:12px; }
    .stat .v{ margin-top:6px; font-size:18px; font-weight: 800; letter-spacing:.2px; }
    .stat .sub{ margin-top:6px; font-size:12px; color: rgba(234,242,255,.72); }

    /* Form */
    form{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    form .full{ grid-column: 1 / -1; }

    .field{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .field label{
      font-size:12px;
      color: var(--muted);
    }
    .field input, .field select, .field textarea{
      width:100%;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      color: var(--text);
      padding: 10px 10px;
      outline: none;
      transition: border-color .15s ease, box-shadow .15s ease;
    }
    .field textarea{ min-height: 78px; resize: vertical; }

    .field input:focus, .field select:focus, .field textarea:focus{
      border-color: rgba(34,197,94,.45);
      box-shadow: 0 0 0 3px rgba(34,197,94,.18);
    }

    .row{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      margin-top: 12px;
    }

    .btn{
      border:0;
      border-radius: 12px;
      padding: 10px 12px;
      font-weight: 800;
      color: #041024;
      cursor:pointer;
      background: linear-gradient(135deg, var(--blue), var(--purple) 55%, var(--green));
      box-shadow: 0 12px 26px rgba(0,0,0,.35);
    }
    .btn:active{ transform: translateY(1px); }

    .btnGhost{
      border-radius: 12px;
      padding: 10px 12px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.05);
      color: var(--text);
      font-weight: 700;
      cursor:pointer;
    }

    .hint{
      color: rgba(234,242,255,.62);
      font-size: 12px;
    }

    /* Table */
    .tableWrap{
      overflow:auto;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.16);
    }

    table{
      width: 100%;
      border-collapse: collapse;
      min-width: 760px;
    }

    thead th{
      text-align:left;
      font-size:12px;
      color: rgba(234,242,255,.70);
      font-weight: 700;
      padding: 12px 12px;
      border-bottom: 1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      position:sticky; top:0;
      backdrop-filter: blur(8px);
    }

    tbody td{
      padding: 12px 12px;
      border-bottom: 1px solid rgba(255,255,255,.06);
      vertical-align: top;
      color: rgba(234,242,255,.88);
    }

    tbody tr:hover td{
      background: rgba(255,255,255,.03);
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      font-weight: 700;
      font-size: 12px;
      color: rgba(234,242,255,.88);
      white-space:nowrap;
    }
    .dot{
      width:8px;height:8px;border-radius:999px;
      background: var(--cyan);
      box-shadow: 0 0 0 3px rgba(34,211,238,.12);
    }
    .dot.purple{ background: var(--purple); box-shadow:0 0 0 3px rgba(124,58,237,.14); }
    .dot.green{ background: var(--green); box-shadow:0 0 0 3px rgba(34,197,94,.14); }

    .amt{
      font-variant-numeric: tabular-nums;
      font-weight: 900;
      letter-spacing:.2px;
    }

    .right{
      text-align:right;
      white-space:nowrap;
    }

    .mini{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      padding: 10px 12px;
      margin-top: 10px;
      border-radius: 12px;
      border: 1px dashed rgba(255,255,255,.16);
      background: rgba(255,255,255,.03);
    }
    .mini .k{ color: rgba(234,242,255,.70); font-size:12px; }
    .mini .v{ font-weight: 900; font-variant-numeric: tabular-nums; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="top">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>CoupleSplit Budget</h1>
          <p>Shared expenses, automatic 50/50 settlement.</p>
        </div>
      </div>

      <div class="controls">
        <div class="chip">
          <label for="month">Month</label>
          <select id="month">
            <option value="2025-12" selected>Dec 2025</option>
            <option value="2026-01">Jan 2026</option>
            <option value="2026-02">Feb 2026</option>
          </select>
        </div>

        <div class="chip">
          <label for="p1">Partner A</label>
          <input id="p1" value="Alex" />
        </div>

        <div class="chip">
          <label for="p2">Partner B</label>
          <input id="p2" value="Sam" />
        </div>
      </div>
    </div>

    <div class="grid">
      <!-- Left: summary + entry form -->
      <section class="card">
        <div class="hd">
          <h2>Month Summary</h2>
          <button class="btnGhost" id="seedBtn" type="button" title="Load sample data">Load samples</button>
        </div>
        <div class="bd">
          <div class="summary">
            <div class="stat">
              <div class="k">Total spend</div>
              <div class="v" id="totalSpend">$0.00</div>
              <div class="sub">All entries in the selected month.</div>
            </div>
            <div class="stat">
              <div class="k">50/50 split</div>
              <div class="v" id="splitEach">$0.00</div>
              <div class="sub">Each partner’s target share.</div>
            </div>
          </div>

          <div class="summary">
            <div class="stat">
              <div class="k" id="p1Label">Alex paid</div>
              <div class="v" id="p1Paid">$0.00</div>
              <div class="sub">Sum of entries attributed to Partner A.</div>
            </div>
            <div class="stat">
              <div class="k" id="p2Label">Sam paid</div>
              <div class="v" id="p2Paid">$0.00</div>
              <div class="sub">Sum of entries attributed to Partner B.</div>
            </div>
          </div>

          <div class="mini">
            <div>
              <div class="k">Settlement (end of month)</div>
              <div class="hint">Positive means Partner B pays Partner A; negative means Partner A pays Partner B.</div>
            </div>
            <div class="v" id="settlement">$0.00</div>
          </div>

          <hr style="border:0;border-top:1px solid rgba(255,255,255,.08); margin:14px 0;">

          <div style="display:flex; align-items:baseline; justify-content:space-between; gap:10px;">
            <h2 style="margin:0; font-size:13px; letter-spacing:.25px; text-transform:uppercase; color:rgba(234,242,255,.86);">Add Entry</h2>
            <div class="hint">Tip: keep it simple; categories are optional.</div>
          </div>

          <form id="entryForm" autocomplete="off" style="margin-top:10px;">
            <div class="field">
              <label for="who">Who paid</label>
              <select id="who">
                <option value="A" selected>Partner A</option>
                <option value="B">Partner B</option>
              </select>
            </div>

            <div class="field">
              <label for="amount">Amount</label>
              <input id="amount" type="number" inputmode="decimal" min="0" step="0.01" placeholder="e.g. 42.50" required />
            </div>

            <div class="field">
              <label for="date">Date</label>
              <input id="date" type="date" required />
            </div>

            <div class="field">
              <label for="category">Category</label>
              <select id="category">
                <option value="Groceries">Groceries</option>
                <option value="Rent/Mortgage">Rent/Mortgage</option>
                <option value="Utilities">Utilities</option>
                <option value="Dining">Dining</option>
                <option value="Transport">Transport</option>
                <option value="Subscriptions">Subscriptions</option>
                <option value="Other" selected>Other</option>
              </select>
            </div>

            <div class="field full">
              <label for="note">Note</label>
              <textarea id="note" placeholder="Optional. e.g. Costco run, hydro bill, etc."></textarea>
            </div>

            <div class="row full">
              <div class="hint">Data is stored in-memory only (refresh wipes it).</div>
              <div style="display:flex; gap:10px;">
                <button class="btnGhost" id="clearBtn" type="button">Clear</button>
                <button class="btn" type="submit">Add entry</button>
              </div>
            </div>
          </form>
        </div>
      </section>

      <!-- Right: entries table -->
      <section class="card">
        <div class="hd">
          <h2>Entries</h2>
          <div class="hint" id="entryCount">0 items</div>
        </div>
        <div class="bd">
          <div class="tableWrap">
            <table aria-label="Expense entries">
              <thead>
                <tr>
                  <th style="width:140px;">Date</th>
                  <th style="width:160px;">Who</th>
                  <th style="width:160px;">Category</th>
                  <th>Note</th>
                  <th class="right" style="width:140px;">Amount</th>
                  <th class="right" style="width:120px;">Action</th>
                </tr>
              </thead>
              <tbody id="tbody">
                <!-- rows injected -->
              </tbody>
            </table>
          </div>
          <div class="hint" style="margin-top:10px;">
            Settlement logic: total / 2 = target each. The partner who paid less owes the difference.
          </div>
        </div>
      </section>
    </div>
  </div>

  <script>
    // Minimal JS to make the UI usable.
    const $ = (id) => document.getElementById(id);

    const state = {
      entries: []
    };

    function fmtMoney(n){
      const x = Number(n || 0);
      return x.toLocaleString(undefined, { style:'currency', currency:'USD' });
    }

    function monthOf(dateStr){
      // YYYY-MM-DD -> YYYY-MM
      return (dateStr || '').slice(0,7);
    }

    function partners(){
      return { A: $('p1').value.trim() || 'Partner A', B: $('p2').value.trim() || 'Partner B' };
    }

    function updatePartnerLabels(){
      const p = partners();
      $('p1Label').textContent = `${p.A} paid`;
      $('p2Label').textContent = `${p.B} paid`;

      // Keep select labels nice
      const who = $('who');
      who.options[0].text = p.A;
      who.options[1].text = p.B;
    }

    function activeMonth(){
      return $('month').value; // YYYY-MM
    }

    function filteredEntries(){
      const m = activeMonth();
      return state.entries.filter(e => monthOf(e.date) === m);
    }

    function compute(){
      const rows = filteredEntries();
      const p = partners();

      let total = 0, a = 0, b = 0;
      for(const e of rows){
        total += e.amount;
        if(e.who === 'A') a += e.amount;
        else b += e.amount;
      }
      const split = total / 2;

      // Settlement: positive => B pays A. negative => A pays B.
      // Derivation: if A paid more than split, B owes A (A - split).
      const settlement = (a - split);

      $('totalSpend').textContent = fmtMoney(total);
      $('splitEach').textContent = fmtMoney(split);
      $('p1Paid').textContent = fmtMoney(a);
      $('p2Paid').textContent = fmtMoney(b);

      const s = settlement;
      const settlementText =
        (Math.abs(s) < 0.005) ? `${p.A} and ${p.B} are even`
        : (s > 0) ? `${p.B} → ${p.A}  ${fmtMoney(s)}`
        : `${p.A} → ${p.B}  ${fmtMoney(-s)}`;

      $('settlement').textContent = settlementText;
    }

    function render(){
      updatePartnerLabels();
      const rows = filteredEntries().slice().sort((x,y)=> (x.date < y.date ? 1 : -1)); // newest first
      $('entryCount').textContent = `${rows.length} item${rows.length === 1 ? '' : 's'}`;

      const p = partners();
      const tbody = $('tbody');
      tbody.innerHTML = '';

      for(const e of rows){
        const tr = document.createElement('tr');

        const whoPill = document.createElement('span');
        whoPill.className = 'pill';

        const dot = document.createElement('span');
        dot.className = 'dot ' + (e.who === 'A' ? 'purple' : 'green');

        whoPill.appendChild(dot);
        whoPill.appendChild(document.createTextNode(e.who === 'A' ? p.A : p.B));

        tr.innerHTML = `
          <td>${e.date}</td>
          <td></td>
          <td><span class="pill"><span class="dot"></span>${escapeHtml(e.category)}</span></td>
          <td>${escapeHtml(e.note || '')}</td>
          <td class="right"><span class="amt">${fmtMoney(e.amount)}</span></td>
          <td class="right"></td>
        `;

        tr.children[1].appendChild(whoPill);

        const btn = document.createElement('button');
        btn.type = 'button';
        btn.className = 'btnGhost';
        btn.textContent = 'Delete';
        btn.onclick = () => {
          state.entries = state.entries.filter(x => x.id !== e.id);
          render(); compute();
        };
        tr.children[5].appendChild(btn);

        tbody.appendChild(tr);
      }

      compute();
    }

    function escapeHtml(s){
      return String(s)
        .replaceAll('&','&amp;')
        .replaceAll('<','&lt;')
        .replaceAll('>','&gt;')
        .replaceAll('"','&quot;')
        .replaceAll("'","&#039;");
    }

    // Defaults: set date to today (or first of month if month differs)
    function setDefaultDate(){
      const m = activeMonth();
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth()+1).padStart(2,'0');
      const dd = String(today.getDate()).padStart(2,'0');
      const todayStr = `${yyyy}-${mm}-${dd}`;

      $('date').value = (todayStr.slice(0,7) === m) ? todayStr : `${m}-01`;
    }

    $('entryForm').addEventListener('submit', (ev) => {
      ev.preventDefault();
      const who = $('who').value;
      const amount = Number($('amount').value);
      const date = $('date').value;
      const category = $('category').value;
      const note = $('note').value.trim();

      if(!date || !Number.isFinite(amount) || amount <= 0) return;

      state.entries.push({
        id: crypto.randomUUID ? crypto.randomUUID() : String(Math.random()).slice(2),
        who, amount, date, category, note
      });

      $('amount').value = '';
      $('note').value = '';
      setDefaultDate();
      render();
    });

    $('clearBtn').addEventListener('click', () => {
      $('amount').value = '';
      $('note').value = '';
      $('category').value = 'Other';
      $('who').value = 'A';
      setDefaultDate();
    });

    $('seedBtn').addEventListener('click', () => {
      const m = activeMonth();
      // Load a few samples for both partners (same month)
      state.entries = [
        { id:'1', who:'A', amount: 86.14, date:`${m}-03`, category:'Groceries', note:'Grocery run' },
        { id:'2', who:'B', amount: 52.40, date:`${m}-05`, category:'Dining', note:'Dinner out' },
        { id:'3', who:'A', amount: 19.99, date:`${m}-08`, category:'Subscriptions', note:'Streaming' },
        { id:'4', who:'B', amount: 120.00, date:`${m}-10`, category:'Utilities', note:'Internet bill' },
        { id:'5', who:'A', amount: 34.20, date:`${m}-12`, category:'Transport', note:'Gas / transit' },
      ];
      render();
    });

    $('month').addEventListener('change', () => {
      setDefaultDate();
      render();
    });

    $('p1').addEventListener('input', render);
    $('p2').addEventListener('input', render);

    // init
    setDefaultDate();
    render();
  </script>
</body>
</html>
